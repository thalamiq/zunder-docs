---
title: 'Compartment Search'
description: 'Search resources within a compartment'
openapi: 'GET /{compartmentType}/{compartmentId}/{resourceType}'
---

## Compartment Search

Search for resources within a specific compartment. Compartments group related resources together (e.g., all resources related to a specific patient).

<ParamField path="compartment_type" type="string" required>
  The compartment type (`Patient`, `Encounter`, `RelatedPerson`, `Practitioner`, `Device`)
</ParamField>

<ParamField path="compartment_id" type="string" required>
  The ID of the compartment resource
</ParamField>

<ParamField path="resource_type" type="string">
  Optional: Filter to a specific resource type within the compartment
</ParamField>

## Endpoint

```
GET /fhir/:compartment_type/:compartment_id/:resource_type
GET /fhir/:compartment_type/:compartment_id/_search
POST /fhir/:compartment_type/:compartment_id/_search
POST /fhir/:compartment_type/:compartment_id/:resource_type/_search
```

## Patient Compartment

Search all resources related to a specific patient:

<CodeGroup>

```bash cURL
curl "https://your-server.com/fhir/Patient/123/Observation?code=http://loinc.org|29463-7"
```

```bash HTTP
GET /fhir/Patient/123/Observation?code=http://loinc.org|29463-7 HTTP/1.1
Host: your-server.com
```

</CodeGroup>

## Encounter Compartment

Search all resources related to a specific encounter:

```bash
GET /fhir/Encounter/456/Observation
```

## All Resources in Compartment

Search all resource types in a compartment:

```bash
GET /fhir/Patient/123/_search
```

Or using POST:

```json
POST /fhir/Patient/123/_search
Content-Type: application/x-www-form-urlencoded

_type=Observation,MedicationRequest&_count=20
```

## Search Parameters

You can combine compartment search with type-specific search parameters:

```bash
GET /fhir/Patient/123/Observation?code=http://loinc.org|29463-7&date=ge2024-01-01&_sort=-date
```

## Response

### Success (200 OK)

Returns a `Bundle` containing resources in the compartment:

```json
{
  "resourceType": "Bundle",
  "type": "searchset",
  "total": 15,
  "entry": [
    {
      "fullUrl": "https://your-server.com/fhir/Observation/789",
      "resource": {
        "resourceType": "Observation",
        "id": "789",
        "subject": {
          "reference": "Patient/123"
        },
        ...
      }
    }
  ]
}
```

## Standard Compartments

### Patient Compartment

Includes resources that reference the patient:
- `Observation`
- `Condition`
- `Procedure`
- `MedicationRequest`
- `Encounter`
- `DiagnosticReport`
- And more...

### Encounter Compartment

Includes resources that reference the encounter:
- `Observation`
- `Procedure`
- `MedicationRequest`
- `DiagnosticReport`
- And more...

### RelatedPerson Compartment

Includes resources related to a related person.

### Practitioner Compartment

Includes resources related to a practitioner.

### Device Compartment

Includes resources related to a device.

## Examples

### All Observations for a Patient

```bash
GET /fhir/Patient/123/Observation
```

### Observations with Specific Code

```bash
GET /fhir/Patient/123/Observation?code=http://loinc.org|29463-7
```

### All Resources in Patient Compartment

```bash
GET /fhir/Patient/123/_search
```

### Filtered Compartment Search

```bash
GET /fhir/Patient/123/Observation?status=final&date=ge2024-01-01&_count=50
```

## Notes

- Compartment membership is determined by resource references
- Not all resources belong to compartments
- Compartment search is more efficient than filtering by reference
- Use compartment search when you know the compartment resource ID
- The compartment ID must exist for the search to work

